## 인터럽트란?

- 사전적 의미로는 '끼어들다', '중단시키다' 정도의 의미를 가진 말
- 프로그램을 실행하는 도중에 예기치 않은 상황이 발생할 경우 현재 실행중인 작업을 중단하고 발생된 상황을 처리한 후 다시 실행중인 작업으로 복귀하는 것

## 인터럽트 종류

- 우선 처리가 필요한 예기치 않은 상황은 무엇일까?

### 외부 인터럽트

보통 외부 입출력장치에 의해 발생.

- 전원 이상 인터럽트(Power fail Interrupt): 정전, 파워 이상 등의 경우.
- 기계 착오 인터럽트(Machine Check Interrupt): CPU의 기능적인 오류의 경우.
- 외부 신호 인터럽트(External Interrupt)
  - 타이머 인터럽트(자원이 할당된 시간이 다 끝난 경우)
  - 키보드로 인터럽트 키를 누른 경우(대표적으로 `Control` + `Alt` + `Delete`)
  - 외부장치로부터 인터럽트 요청이 있는 경우
- 입출력 인터럽트(I/O Interrupt): 입출력 장치가 데이터 전송을 요구하거나 다음 동작이 수행되어야 할 경우, 입출력 데이터에 이상이 있는 경우.

> **❗외부장치로부터 인터럽트 요청 VS I/O 인터럽트**
>
> - **외부 장치 인터럽트:** 외부 장치에서 발생하는 **모든 종류의 인터럽트** (키보드, 마우스, 네트워크 카드 등)로 하드웨어 장치에서 특정 작업을 처리할 필요가 있을 때 발생
> - **I/O 인터럽트**: **입출력 장치**와 관련된 인터럽트 (디스크, 프린터, 네트워크 카드 등)로 **입출력 작업**이 완료되거나, **데이터 전송**이 필요하거나, **오류**가 발생했을 때 발생

### 내부 인터럽트

잘못된 명령이나 잘못된 데이터를 사용할 때 발생, **Trap**이라고 부름

- 프로그램 검사 인터럽트(Program Check Interrupt)
  - 0으로 나눈 경우
  - Overflow/Underflow
  - 기타 예외 경우.

### 소프트웨어 인터럽트

프로그램 처리 중 명령 요청에 의해서 발생.

- SVC(SuperVisor Call): 사용자가 프로그램을 실행시키거나 감시프로그램을 호출하는 동작을 수행한 경우, 복잡한 입출력 처리를 한 경우.

## 인터럽트 동작 순서

1. 인터럽트 요청
2. 프로그램 중단: CPU는 현재 진행 중인 기계어 코드를 완료한다.
3. 현재의 프로그램 상태 보존
   - 현재까지 수행중이었던 상태를 **해당 process의 PCB**(Process Control Block)에 저장한다. (수행중이던 MEMORY주소, 레지스터 값, 하드웨어 상태 등...)
   - PC(Program Counter, IP)에 다음에 실행할 명령의 주소를 저장한다.
4. 인터럽트 처리 루틴 실행 - 인터럽트를 요청한 장치를 식별한다.
5. 인터럽트 서비스 루틴 실행 : 인터럽트 원인을 파악하고 실질적인 작업을 수행. 서비스 루틴 수행 중 우선 순위가 더 높은 인터럽트가 발생하면 또 재귀적으로 1~5를 수행
6. 상태복구 : 인터럽트 발생 시 저장해둔 PC(Program counter)를 다시 복구한다.
7. 중단된 프로그램 실행 재개 : PC의 값을 이용하여 이전에 수행중이던 프로그램을 재개한다.

## 인터럽트 우선순위

- 일반적으로 **하드웨어 인터럽트**가 **소프트웨어 인터럽트**보다 우선 순위가 높고 내부 인터럽트보다 외부 인터럽트가 우선 순위가 높음

1. 전원 이상
2. 기계 착오
3. 외부 신호
4. 입출력 신호
5. 명령어 잘못
6. 프로그램 검사
7. SVC

## 면접질문

- 인터럽트란 무엇인가요
- 인터럽트와 시스템 콜의 차이에 대해 설명해주세요

  > 시스템콜 VS 인터럽트
  >
  > (목적과 발생방식)
  >
  > - **시스템 콜**은 애플리케이션이 **커널의 서비스를 요청**하는 메커니즘이며, 사용자가 커널 리소스에 접근하기 위해 능동적으로 호출
  > - **인터럽트**는 **하드웨어나 소프트웨어 이벤트에 의해 비동기적으로 발생**하는 신호로, CPU가 현재 작업을 중단하고 해당 사건을 처리하게 만듦
  >   - **비동기적으로 발생?** = **CPU가 현재 실행 중인 작업과 관계없이, 예기치 않은 시점에 발생할 수 있다**
  >
  > (관계)
  >
  > - 시스템 콜은 소프트웨어 인터럽트를 통해 구현되는 경우가 많음. 애플리케이션이 시스템 콜을 호출할 때, 소프트웨어 인터럽트가 발생하여 커널로 제어가 넘어가고, 커널이 해당 요청을 처리한 후 결과를 반환 → **응용프로그램에서 시스템 콜을 호출하면 0x80 인터럽트가 발생**

- 한컴오피스 ‘한글’을 클릭 후 빈 화면에 커서가 깜빡이고 있다. 이때 Hello World를 작성하면 컴퓨터 내부에서 어떤 일이 발생하는가?

> 1.  키보드에서 사용자 입력이 들어오면 키보드 컨트롤러가 인터럽트를 발생시켜 CPU에게 키가 입력되었다는 사실을 알려준다. (인터럽트 요청)
> 2.  CPU는 현재 수행중이던 작업의 상태를 저장하고 인터럽트 요청을 처리하기 위해 OS내에 정의된 키보드 인터럽트 처리 루틴을 찾아간다.
> 3.  키보드 인터럽트 처리 루틴은 키보드로부터 입력받은 내용을 메모리의 특정 부분에 저장해 해당 프로그램에 게 키보드 입력이 들어왔음을 알리며 인터럽트 처리를 완료한다.
> 4.  인터럽트 처리가 끝나면 인터럽트가 발생하기 직전 상태를 복구시켜 중단되었던 작업을 재개한다.

## 참고자료

[https://velog.io/@wngkdroqkf441/CS-운영체제-인터럽트란](https://velog.io/@wngkdroqkf441/CS-%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C-%EC%9D%B8%ED%84%B0%EB%9F%BD%ED%8A%B8%EB%9E%80)

[https://velog.io/@qweadzs/CS-인터럽트interupt](https://velog.io/@qweadzs/CS-%EC%9D%B8%ED%84%B0%EB%9F%BD%ED%8A%B8interupt)

[https://raisonde.tistory.com/entry/인터럽트Interrupt의-개념과-종류](https://raisonde.tistory.com/entry/%EC%9D%B8%ED%84%B0%EB%9F%BD%ED%8A%B8Interrupt%EC%9D%98-%EA%B0%9C%EB%85%90%EA%B3%BC-%EC%A2%85%EB%A5%98)

https://gyeong-log.tistory.com/63
